<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gittargets">
<title>Tutorial: Git data backend • gittargets</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tutorial: Git data backend">
<meta property="og:description" content="gittargets">
<meta property="og:image" content="https://docs.ropensci.org/gittargets/logo.svg">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">gittargets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.7.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://docs.ropensci.org/targets">targets</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Vignettes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/gittargets">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Tutorial: Git data backend</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/gittargets/blob/HEAD/vignettes/git.Rmd" class="external-link"><code>vignettes/git.Rmd</code></a></small>
      <div class="d-none name"><code>git.Rmd</code></div>
    </div>

    
    
<p>This tutorial shows how to use <code>gittargets</code> with the Git-based data versioning backend. Before proceeding, please read the <a href="https://github.com/ropensci/gittargets/blob/main/README.md" class="external-link">README</a> file or <a href="https://docs.ropensci.org/gittargets/">documentation website front page</a> for an overview of the package.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Please begin with the installation instructions on the <a href="https://docs.ropensci.org/gittargets/">documentation website</a>. In addition, if your <code>targets</code> pipeline generates large data files, consider installing <a href="https://git-lfs.com" class="external-link">Git LFS</a>. The Git data backend in <code>gittargets</code> automatically opts into <a href="https://git-lfs.com" class="external-link">Git LFS</a>, so you should not need to do any manual configuration to reap the performance benefits.</p>
</div>
<div class="section level2">
<h2 id="remotes">Remotes<a class="anchor" aria-label="anchor" href="#remotes"></a>
</h2>
<p>This backend is uses local <a href="https://git-scm.com" class="external-link">Git</a> only. It is possible to push the snapshotted <a href="https://books.ropensci.org/targets/data.html" class="external-link">data store</a> to a cloud service like <a href="https://github.com" class="external-link">GitHub</a>, <a href="https://about.gitlab.com" class="external-link">GitLab</a>, or <a href="https://bitbucket.org" class="external-link">Bitbucket</a>, but this is the user’s responsibility. Pipelines usually generate large data files, and <a href="https://github.com" class="external-link">GitHub</a> and its peers have file size limitations. Also, <code>gittargets</code> automatically opts into <a href="https://git-lfs.com" class="external-link">Git LFS</a> locally (unless <code>git_lfs</code> is <code>FALSE</code> in <code><a href="../reference/tar_git_init.html">tar_git_init()</a></code>), and <a href="https://git-lfs.com" class="external-link">Git LFS</a> on the cloud is a paid service.</p>
</div>
<div class="section level2">
<h2 id="overall-workflow">Overall workflow<a class="anchor" aria-label="anchor" href="#overall-workflow"></a>
</h2>
<p>The most important steps of the Git data backend are as follows. The rest of this vignette walks through these steps in greater depth.</p>
<ol style="list-style-type: decimal">
<li>Create the source code and run the pipeline at least once so the <a href="https://books.ropensci.org/targets/data.html" class="external-link">data store</a> exists.</li>
<li>
<code><a href="../reference/tar_git_init.html">tar_git_init()</a></code>: initialize a <a href="https://git-scm.com" class="external-link">Git</a>/<a href="https://git-lfs.com" class="external-link">Git-LFS</a> repository for the <a href="https://books.ropensci.org/targets/data.html" class="external-link">data store</a>.</li>
<li>Bring the pipeline up to date (e.g. with <a href="https://docs.ropensci.org/targets/reference/tar_make.html" class="external-link"><code>tar_make()</code></a>) and commit any changes to the source code.</li>
<li>
<code><a href="../reference/tar_git_snapshot.html">tar_git_snapshot()</a></code>: create a data snapshot for the current code commit.</li>
<li>Develop the pipeline. Creating new code commits and code branches early and often, and create data snapshots at key strategic milestones.</li>
<li>
<code><a href="../reference/tar_git_checkout.html">tar_git_checkout()</a></code>: revert the data to the appropriate prior snapshot.</li>
</ol>
</div>
<div class="section level2">
<h2 id="create-code">Create code<a class="anchor" aria-label="anchor" href="#create-code"></a>
</h2>
<p>To begin development, we write <code>_targets.R</code> file for a <a href="https://docs.ropensci.org/targets/" class="external-link"><code>targets</code></a> pipeline. <a href="https://docs.ropensci.org/targets/" class="external-link"><code>targets</code></a> can handle large complex pipelines for <a href="https://github.com/wlandau/targets-keras" class="external-link">machine learning</a>, <a href="https://github.com/wlandau/rmedicine2021-pipeline" class="external-link">Bayesian data analysis</a>, and much more. However, this tutorial focuses on a much simpler pipeline for the sake of pedagogical simplicity.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># _targets.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html" class="external-link">tar_target</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/airquality.html" class="external-link">airquality</a></span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html" class="external-link">tar_target</a></span><span class="op">(</span><span class="va">result</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-pipeline">Run pipeline<a class="anchor" aria-label="anchor" href="#run-pipeline"></a>
</h2>
<p>With our target script in hand, we run the pipeline.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;&lt;a href="https://books.ropensci.org/targets/hpc.html" class="external-link uri"&gt;https://books.ropensci.org/targets/hpc.html&lt;/a&gt; describes heavy-duty alternatives to &lt;code&gt;&lt;a href="https://docs.ropensci.org/targets/reference/tar_make.html" class="external-link"&gt;tar_make()&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt;'><sup>1</sup></a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_make.html" class="external-link">tar_make</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We inspect the output with <code><a href="https://docs.ropensci.org/targets/reference/tar_read.html" class="external-link">tar_read()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html" class="external-link">tar_read</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="commit-code">Commit code<a class="anchor" aria-label="anchor" href="#commit-code"></a>
</h2>
<p>We usually iterate between writing code and running the pipeline until we have a decent set of results. After that, we commit the code to a <a href="https://git-scm.com/docs/git-pack-refs" class="external-link">Git</a> repository, which may or may not live on <a href="https://github.com" class="external-link">GitHub</a>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Alternatives to GitHub include GitLab and Bitbucket.&lt;/p&gt;"><sup>2</sup></a> <a href="https://happygitwithr.com" class="external-link">Happy Git with R</a> is a great way to learn Git, and the <a href="https://docs.ropensci.org/gert/" class="external-link"><code>gert</code></a> package is a convenient way to interact with Git from R.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/gert/" class="external-link">gert</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_repo.html" class="external-link">git_init</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_add</a></span><span class="op">(</span><span class="st">"_targets.R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_commit</a></span><span class="op">(</span><span class="st">"Begin analyzing the airquality dataset"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_branch.html" class="external-link">git_branch_create</a></span><span class="op">(</span><span class="st">"airquality"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="snapshot-data">Snapshot data<a class="anchor" aria-label="anchor" href="#snapshot-data"></a>
</h2>
<p>Before we snapshot the data, we should check that the code is up to date in the Git repository and the targets are up to date in the pipeline. The <code><a href="../reference/tar_git_status.html">tar_git_status()</a></code> function is an easy way to do this.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Helper functions &lt;code&gt;&lt;a href="../reference/tar_git_status_code.html"&gt;tar_git_status_code()&lt;/a&gt;&lt;/code&gt;, &lt;code&gt;&lt;a href="../reference/tar_git_status_targets.html"&gt;tar_git_status_targets()&lt;/a&gt;&lt;/code&gt;, and &lt;code&gt;&lt;a href="../reference/tar_git_status_data.html"&gt;tar_git_status_data()&lt;/a&gt;&lt;/code&gt; each generate a piece of the &lt;code&gt;&lt;a href="../reference/tar_git_status.html"&gt;tar_git_status()&lt;/a&gt;&lt;/code&gt; output.&lt;/p&gt;'><sup>3</sup></a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tar_git_status.html">tar_git_status</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Our code and pipeline look ready for a data snapshot. First, we initialize the data repository with <code><a href="../reference/tar_git_init.html">tar_git_init()</a></code>. <code><a href="../reference/tar_git_init.html">tar_git_init()</a></code> writes a <code>.gitattributes</code> file in the data store that automatically opts into <a href="https://git-lfs.com" class="external-link">Git LFS</a>. If you have <a href="https://git-lfs.com" class="external-link">Git LFS</a> but do not wish to use it, please remove the <code>.gitattributes</code> after calling <code><a href="../reference/tar_git_init.html">tar_git_init()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tar_git_init.html">tar_git_init</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Then, we create our first data commit with <code><a href="../reference/tar_git_snapshot.html">tar_git_snapshot()</a></code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Ordinarily, &lt;code&gt;&lt;a href="../reference/tar_git_snapshot.html"&gt;tar_git_snapshot()&lt;/a&gt;&lt;/code&gt; shows runs &lt;code&gt;&lt;a href="../reference/tar_git_status.html"&gt;tar_git_status()&lt;/a&gt;&lt;/code&gt; and prompts the user to confirm the snapshot. But in this example, we skip this step.&lt;/p&gt;'><sup>4</sup></a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tar_git_snapshot.html">tar_git_snapshot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="snapshot-model">Snapshot model<a class="anchor" aria-label="anchor" href="#snapshot-model"></a>
</h3>
<p><img src="snapshot-model-git.png"></p>
<p>In the Git data backend, a data snapshot is a special kind of Git commit (gray boxes above). Each data commit is part of a data branch (vertical dashed lines above), and each data branch is specific to the current code commit (green and brown boxes above). In fact, each data branch name is of the form <code>"code=&lt;SHA1&gt;"</code>, where <code>&lt;SHA1&gt;</code> is the Git SHA1 hash of the corresponding code commit. You can always create a data snapshot, but it will supersede any prior data snapshot you already have for the current code commit. To revert to a previous data snapshots for a given code snapshot, you will need to manually enter the repository and check out the relevant data commit.</p>
</div>
</div>
<div class="section level2">
<h2 id="repeat">Repeat<a class="anchor" aria-label="anchor" href="#repeat"></a>
</h2>
<p>Development typically happens in cycles: develop the code, run the pipeline, commit the code, snapshot the data, and repeat. Not all code commits need a data snapshot, especially if the <a href="https://docs.ropensci.org/targets/" class="external-link"><code>targets</code></a> pipeline generates a lot of data. But even then, it is helpful to snapshot the data at key milestones, e.g. if an alternative research question comes up and it is desirable to create a new Git branch for the code. For example, suppose we wish to apply the same pipeline to a different dataset. The code changes:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># _targets.R</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/targets/" class="external-link">targets</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html" class="external-link">tar_target</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu">datasets</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/datasets/UKgas.html" class="external-link">UKgas</a></span><span class="op">)</span>, <span class="co"># different dataset</span></span>
<span>  <span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_target.html" class="external-link">tar_target</a></span><span class="op">(</span><span class="va">result</span>, <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We run the pipeline and inspect the new output.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_make.html" class="external-link">tar_make</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html" class="external-link">tar_read</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>We put the code in a new Git branch.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_branch.html" class="external-link">git_branch_create</a></span><span class="op">(</span><span class="st">"UKgas"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_add</a></span><span class="op">(</span><span class="st">"_targets.R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_commit.html" class="external-link">git_commit</a></span><span class="op">(</span><span class="st">"Switch to UKgas dataset"</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we create a data snapshot for the new code commit.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tar_git_snapshot.html">tar_git_snapshot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="view-log">View log<a class="anchor" aria-label="anchor" href="#view-log"></a>
</h2>
<p>Now, suppose we want to switch the project back to the original dataset (<code>airquality</code>). To transition completely, we need to revert both the code and the data. If we only revert the code, then the data store will sill reflect the <code>UKgas</code> dataset, and none of our targets will be up to date. At this point, it is a good time to pause and check the <code>gittargets</code> log to see which code commits have available data snapshots.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;If you chose not to call &lt;code&gt;&lt;a href="../reference/tar_git_snapshot.html"&gt;tar_git_snapshot()&lt;/a&gt;&lt;/code&gt; for some code commits, then not all your code commits will have available data snapshots.&lt;/p&gt;'><sup>5</sup></a></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tar_git_log.html">tar_git_log</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-out-code">Check out code<a class="anchor" aria-label="anchor" href="#check-out-code"></a>
</h2>
<p>To check out the old <code>airquality</code> code, we use <code><a href="https://docs.ropensci.org/gert/reference/git_branch.html" class="external-link">gert::git_branch_checkout()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_branch.html" class="external-link">git_branch_checkout</a></span><span class="op">(</span><span class="st">"airquality"</span><span class="op">)</span></span></code></pre></div>
<p>But because we did not revert the data, our results still reflect the <code>UKgas</code> dataset.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html" class="external-link">tar_read</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>Thus, all our targets are out of date.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_outdated.html" class="external-link">tar_outdated</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-out-data">Check out data<a class="anchor" aria-label="anchor" href="#check-out-data"></a>
</h2>
<p>To bring our targets back up to date with the <code>airquality</code> data, instead of beginning a potentially long computation with <code><a href="https://docs.ropensci.org/targets/reference/tar_make.html" class="external-link">tar_make()</a></code>, we can check out the data snapshot that matches our current code commit.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tar_git_checkout.html">tar_git_checkout</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now, our results reflect the <code>airquality</code> dataset we previously analyzed.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_read.html" class="external-link">tar_read</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre></div>
<p>And all our targets are up to date.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://docs.ropensci.org/targets/reference/tar_outdated.html" class="external-link">tar_outdated</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="merges">Merges<a class="anchor" aria-label="anchor" href="#merges"></a>
</h2>
<p>It is common to <a href="https://git-scm.com/docs/git-merge" class="external-link">merge</a> code branches into one another. When this happens, a new merge commit is created in the code repository, and the data repository remains unchanged. In fact, the only change is that the code repository is now at a new commit that has no data snapshot yet. If you wish, simply create a new data snapshot with <code><a href="../reference/tar_git_snapshot.html">tar_git_snapshot()</a></code>. If the code commit immediately prior had an up-to-date data snapshot of its own, then the new snapshot for the merge commit should cost little storage or runtime.</p>
</div>
<div class="section level2">
<h2 id="custom-data-files">Custom data files<a class="anchor" aria-label="anchor" href="#custom-data-files"></a>
</h2>
<p>Only files inside the <code>targets</code> data store are tracked in a <code>gittargets</code> data snapshot. If your pipeline requires custom external files, you may put them in a folder called <code>_targets/user/</code>. That way, <code>gittargets</code> will automatically put them under data version control in the next snapshot.</p>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>If your <code>targets</code> pipeline generates large data files, consider installing <a href="https://git-lfs.com" class="external-link">Git LFS</a>. Once you install <a href="https://git-lfs.com" class="external-link">Git LFS</a>, it should just work on your project right out of the box because <code><a href="../reference/tar_git_init.html">tar_git_init()</a></code> writes the following to <code>_targets/.gitattributes</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="ex">objects</span> filter=lfs diff=lfs merge=lfs <span class="at">-text</span></span></code></pre></div>
<p>In addition, every data snapshot with <code><a href="../reference/tar_git_snapshot.html">tar_git_snapshot()</a></code> creates a new Git branch. With thousands of commits and thus thousands of branches, performance may suffer unless you ensure <code>pack_refs</code> is <code>TRUE</code> in the function call (default).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Alternatively, you can call &lt;code&gt;tar_git_snapshot(pack_refs = FALSE)&lt;/code&gt; and then afterwards run &lt;code&gt;git pack-refs --all&lt;/code&gt;&lt;/p&gt;"><sup>6</sup></a>(<a href="https://git-scm.com/docs/git-pack-refs" class="external-link uri">https://git-scm.com/docs/git-pack-refs</a>) in the command line with your working directory inside <code>_targets/</code>.]</p>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
